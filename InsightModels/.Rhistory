sw.graph <- summarySE(SWS_data2, measurevar = "SWdens", groupvars = c("BlockN", "Treatment"))
sw.graph$Treatment<-ordered(sw.graph$Treatment, c("PLA","MPH","ATM","CIT"))
##Graph with Standard Error
ggplot(sw.graph, aes(x = BlockN, y = SWdens, colour = Treatment)) + geom_point() + geom_line() +  ggtitle("Mean Slow Wave Density According To Block Number and Treatment") + ylab("Mean Slow Wave Density") + xlab("Block Number")+ geom_ribbon(aes(ymin = SWdens-se, ymax = SWdens+se, fill = Treatment), alpha = .35, linetype = 0) + scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + scale_colour_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + scale_x_continuous(breaks = c(1:10))
##Barplot
sw2.graph <- summarySE(SWS_data2, measurevar = "SWdens", groupvars = c( "Treatment"))
sw2.graph$Treatment<-ordered(sw2.graph$Treatment,c("PLA","MPH","ATM","CIT"))
ggplot(data=sw2.graph, aes(x=Treatment, y=SWdens, fill = Treatment)) +
geom_bar(stat="identity") + geom_errorbar(aes(ymin = SWdens-se, ymax = SWdens+se), width = .5, size = .6) + scale_fill_discrete( name = "Treatment", breaks = c("PLA", "MPH", "ATM", "CIT"), labels = c("Placebo", "Methylphenidate", "Atomoxetine", "Citalopram")) + ylab("Mean Slow Wave Density")+ scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + coord_cartesian(ylim =c(4, 5)) + ggtitle("Mean Slow Wave Density For Each Treatment")
##Slow wave density
lm.sw0 <- lmer(SWdens ~ 1 + (1|SubID), data = SWS_data2, REML =FALSE)
##Effects of electrode placement and block number on slow wave density
lm.sw1 <- lmer(SWdens  ~ 1  + BlockN + (1|SubID), data = SWS_data2, REML = FALSE)
##Effects of electrode placement, block number and drug on slow wave density
lm.sw2 <- lmer(SWdens  ~ 1  + BlockN + Treatment + (1|SubID), data = SWS_data2, REML = FALSE)
##Effects of the interaction between electrode placement, block number and drug on slow wave density
lm.sw3 <- lmer(SWdens  ~ 1 + BlockN*Treatment + (1|SubID), data = SWS_data2, REML = FALSE)
##Anova to see which one has the most interaction
anova(lm.sw0,lm.sw1,lm.sw2, lm.sw3)
summary(lm.sw2)
confint(lm.sw2, method = "Wald", oldNames = FALSE)
## Normality plot of residuals
hist(residuals(lm.sw2))
boxplot(residuals(lm.sw2))
qqnorm(resid(lm.sw2))
qqline(resid(lm.sw2))
plot(lm.sw2)
plot(fitted(lm.sw2), resid(lm.sw2))
##Slow wave density
lm.sw0 <- lmer(SWdens ~ 1 + (1|SubID), data = SWS_data, REML =FALSE)
##Effects of electrode placement on slow wave density
lm.sw1 <- lmer(SWdens  ~ 1 + Elec + (1|SubID), data = SWS_data, REML = FALSE)
##Effects of electrode placement and block number on slow wave density
lm.sw2 <- lmer(SWdens  ~ 1 + Elec + BlockN + (1|SubID), data = SWS_data, REML = FALSE)
##Effects of electrode placement, block number and drug on slow wave density
lm.sw3 <- lmer(SWdens  ~ 1 + Elec + BlockN + Treatment + (1|SubID), data = SWS_data, REML = FALSE)
##Effects of electrode placement interacting between block number and drug on slow wave density
lm.sw4 <- lmer(SWdens  ~ 1 + Elec*(BlockN + Treatment) + (1|SubID), data = SWS_data, REML = FALSE)
##Effects of the interaction between electrode placement, block number and drug on slow wave density
#lm.sw5 <- lmer(SWdens  ~ 1 + Elec*BlockN*Treatment + (1|SubID), data = SWS_data, REML = FALSE)
##Anova to see which one has the most interaction
anova(lm.sw0,lm.sw1,lm.sw2, lm.sw3, lm.sw4) #, lm.sw5)
lm.sw4 <- lmer(SWdens  ~ 1 + Elec*(BlockN + Treatment) + (1|SubID), data = SWS_data, REML = TRUE)
summary(lm.sw4)
confint(lm.sw4, method = "Wald", oldNames = FALSE)
## Normality plot of residuals
hist(residuals(lm.sw4))
boxplot(residuals(lm.sw4))
qqnorm(resid(lm.sw4))
qqline(resid(lm.sw4))
plot(lm.sw4)
plot(fitted(lm.sw4), resid(lm.sw4))
anova(lm.sw0,lm.sw1,lm.sw2, lm.sw3, lm.sw4) #, lm.sw5)
nback_data <- read.table("/Users/tand0009/Data/PowerSleep/N-back POWERsleep_forR.csv", header = TRUE, sep = ",", stringsAsFactors = FALSE)
nback_data <- read.table("/Users/tand0009/Data/PowerSleep/N-back POWERsleep_forR.csv", header = TRUE, sep = ",", stringsAsFactors = FALSE)
View(nback_data)
library(lmerTest)
lm.FA0 <- lmer(dprime ~ 1 + Difficulty + (1|SubID), data = nback_data, REML = FALSE)
lm.behav0 <- lmer(dprime ~ 1 + Difficulty + (1|SubID), data = nback_data, REML = FALSE)
summary(lm.behav0)
ggplot(nback_data, aes(x = Difficulty, y = dprime, colour = Treatment))
+ geom_point() + geom_line() + ylab("dprime") + xlab("Difficulyt")
+ scale_fill_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77")) + scale_colour_manual(values = c("#666666", "#d95f02", "#7570b3", "#1b9e77"))
ggplot(nback_data, aes(x = Difficulty, y = dprime, colour = Treatment))
+ geom_point() + geom_line() + ylab("dprime") + xlab("Difficulty")
library(ggplot2)
library(ggpubr)
ggplot(nback_data, aes(x = Difficulty, y = dprime, colour = Treatment))
+ geom_point() + geom_line() + ylab("dprime") + xlab("Difficulty")
ggplot(nback_data, aes(x = Difficulty, y = dprime, colour = Difficulty))
+ geom_point() + geom_line() + ylab("dprime") + xlab("Difficulty")
ggplot(nback_data, aes(x = Difficulty, y = dprime, colour = Difficulty)) + geom_point() + geom_line() + ylab("dprime") + xlab("Difficulty")
ggplot(nback_data, aes(x = Difficulty, y = dprime, colour = Difficulty)) + geom_bar() + geom_line() + ylab("dprime") + xlab("Difficulty")
ggplot(nback_data, aes(x = Difficulty, y = dprime, colour = Difficulty)) + geom_bar() + ylab("dprime") + xlab("Difficulty")
ggplot(nback_data, aes(x = Difficulty, y = dprime, colour = Difficulty)) + geom_bar() + geom_line() + ylab("dprime") + xlab("Difficulty")
ggplot(nback_data, aes(x = Difficulty, y = dprime, colour = Difficulty)) + geom_point() + geom_line() + ylab("dprime") + xlab("Difficulty")
lm.behav1 <- lmer(dprime ~ 1 + Difficulty+Condition + (1|SubID), data = nback_data, REML = FALSE)
lm.behav2 <- lmer(dprime ~ 1 + Difficulty*Condition + (1|SubID), data = nback_data, REML = FALSE)
anova(lm.behav0,lm.behav1,lm.behav2)
nback_data <- read.table("/Users/tand0009/Data/PowerSleep/N-back POWERsleep_forR.csv", header = TRUE, sep = ",", stringsAsFactors = FALSE)
lm.behav0 <- lmer(dprime ~ 1 + Difficulty + (1|SubID), data = nback_data, REML = FALSE)
ggplot(nback_data, aes(x = Difficulty, y = dprime, colour = Difficulty)) + geom_point() + geom_line() + ylab("dprime") + xlab("Difficulty")
lm.behav1 <- lmer(dprime ~ 1 + Difficulty+Condition + (1|SubID), data = nback_data, REML = FALSE)
lm.behav2 <- lmer(dprime ~ 1 + Difficulty*Condition + (1|SubID), data = nback_data, REML = FALSE)
anova(lm.behav0,lm.behav1,lm.behav2)
summary(lm.behav1)
ls_data <- read.table("/Users/tand0009/Data/PowerSleep/PowerSleep_LocalSleep_PVT.csv", header = TRUE, sep = ",", stringsAsFactors = FALSE)
View(ls_data)
View(ls_data)
ls_data <- read.table("/Users/tand0009/Data/PowerSleep/PowerSleep_LocalSleep_PVT.csv", header = TRUE, sep = ",", stringsAsFactors = FALSE)
lm.behav0 <- lmer(dprime ~ 1 + Difficulty + (1|SubID), data = nback_data, REML = FALSE)
ggplot(data=nback_data, aes(x=Difficulty, y=dprime, fill = Difficulty)) +
geom_bar(stat="identity")
ls_data <- read.table("/Users/tand0009/Data/PowerSleep/PowerSleep_LocalSleep_PVT.csv", header = TRUE, sep = ",", stringsAsFactors = FALSE)
lm.LS0 <- lmer(AV ~ 1 + nPVT + (1|SubID), data = ls_data, REML = FALSE)
ggplot(data=ls_data, aes(x=nPVT, y=AV, fill = nPVT)) +
geom_bar(stat="identity")
summary(lm.LS0)
geom_bar(stat="identity")
ggplot(data=ls_data, aes(x=nPVT, y=Fz, fill = nPVT)) +
geom_bar(stat="identity")
ggplot(data=ls_data, aes(x=nPVT, y=Cz, fill = nPVT)) +
geom_bar(stat="identity")
ggplot(data=ls_data, aes(x=nPVT, y=Oz, fill = nPVT)) +
geom_bar(stat="identity")
lm.LS0 <- lmer(Fz ~ 1 + nPVT + (1|SubID), data = ls_data, REML = FALSE)
ggplot(data=ls_data, aes(x=nPVT, y=Fz, fill = nPVT)) +
geom_bar(stat="identity")
lm.LS1 <- lmer(Fz ~ 1 + Condition+nPVT + (1|SubID), data = ls_data, REML = FALSE)
lm.LS2 <- lmer(Fz ~ 1 + Condition*nPVT + (1|SubID), data = ls_data, REML = FALSE)
summary(lm.LS0)
ggplot(data=ls_data, aes(x=Condition, y=Fz, fill = Condition)) +
geom_bar(stat="identity")
View(ls_data)
ggplot(data=ls_data, aes(x=Cond, y=Fz, fill = Cond)) +
geom_bar(stat="identity")
setwd("~/WorkGit/projects/inprogress/Edison_scripts/InsightModels")
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(lme4)
data <- read.table("../Edison_Tables/Clean_Data.csv", header = TRUE, sep = ",", stringsAsFactors = FALSE)
data <- read.table("../Edison_Tables/Clean_Data.txt", header = TRUE, sep = ",", stringsAsFactors = FALSE)
data <- read.table("../Edison_Tables/Clean_Data.txt", header = TRUE, sep = ",", stringsAsFactors = FALSE)
library(ggplot2)
library(lme4)
data <- read.table("../Edison_Tables/Clean_Data.txt", header = TRUE, sep = ",", stringsAsFactors = FALSE)
nsims<-100
View(data)
View(data)
data <- read.table("../Edison_Tables/Clean_Data.txt", header = TRUE, sep = ",", stringsAsFactors = FALSE)
?glmer
mdl0=glmer('InsightPost~1+SleepEdison+Age+Gender+Epworth+DreamRecall+EduLevel+Laterality+UsedToEnigmas',glmer,family='binomial')
mdl0=glmer('InsightPost~1+SleepEdison+Age+Gender+Epworth+DreamRecall+EduLevel+Laterality+UsedToEnigmas',data,family='binomial')
?glm
mdl0=glm('InsightPost~1+SleepEdison+Age+Gender+Epworth+DreamRecall+EduLevel+Laterality+UsedToEnigmas',family='binomial',data)
summary(mdl0)
mdl1=glm('InsightPost~1+SleepEdison+Bottle+Age+Gender+Epworth+DreamRecall+EduLevel+Laterality+UsedToEnigmas',family='binomial',data)
mdl1
summary(mdl1)
anova(mdl0,mdl1)
anova(mdl0,mdl1, test = "Chisq")
mdl0=glm('InsightPost~1+Age+Gender+Epworth+DreamRecall+EduLevel+Laterality+UsedToEnigmas',family='binomial',data)
mdl1=glm('InsightPost~1+SleepEdison+Age+Gender+Epworth+DreamRecall+EduLevel+Laterality+UsedToEnigmas',family='binomial',data)
anova(mdl0,mdl1, test = "Chisq")
mdl2=glm('InsightPost~1+SleepEdison+Bottle+Age+Gender+Epworth+DreamRecall+EduLevel+Laterality+UsedToEnigmas',family='binomial',data)
anova(mdl1,mdl2, test = "Chisq")
mdl0=glm('InsightPost~1+Age+Gender+Epworth+DreamRecall+EduLevel+Laterality+UsedToEnigmas',family='binomial',data)
mdl1=glm('InsightPost~1+SleepEdison+Age+Gender+Epworth+DreamRecall+EduLevel+Laterality+UsedToEnigmas',family='binomial',data)
anova(mdl0,mdl1, test = "Chisq")
mdl2=glm('InsightPost~1+Bottle+Age+Gender+Epworth+DreamRecall+EduLevel+Laterality+UsedToEnigmas',family='binomial',data)
anova(mdl0,mdl2, test = "Chisq")
mdl3=glm('InsightPost~1+SleepEdison*Bottle+Age+Gender+Epworth+DreamRecall+EduLevel+Laterality+UsedToEnigmas',family='binomial',data)
summary(mdl3)
anova(mdl1,mdl3, test = "Chisq")
mdl4=glm('InsightPost~1+SleepEdison+HypnoEdisonN1+HypnoEdisonN2+Age+Gender+Epworth+DreamRecall+EduLevel+Laterality+UsedToEnigmas',family='binomial',data)
anova(mdl1,mdl4, test = "Chisq")
summary(mdl4)
```{r}
mdl4=glm('InsightPost~1+SleepEdison+HypnoEdisonN1+HypnoEdisonN2+Age+Gender+Epworth+DreamRecall+EduLevel+Laterality+UsedToEnigmas',family='binomial',data)
```
Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
```{r}
mdl4=glm('InsightPost~1+SleepEdison+HypnoEdisonN1+HypnoEdisonN2+Age+Gender+Epworth+DreamRecall+EduLevel+Laterality+UsedToEnigmas',family='binomial',data)
summmary(mdl4)
summary(mdl4)
colnames(data)
```{r}
mdl5=glm('InsightPost~1+SleepEdison+HypnoEdisonN1+HypnoEdisonN2+Hypnagogia+HypnaBottle+HypnaTask+
Age+Gender+Epworth+DreamRecall+EduLevel+Laterality+UsedToEnigmas',family='binomial',data)
summary(mdl5)
library(ggplot2)
library(lme4)
data <- read.table("../Edison_Tables/Clean_Data_SS_Pow.txt", header = TRUE, sep = ",", stringsAsFactors = FALSE)
mdl0=glm('InsightPost~1+Age+Gender+Epworth+DreamRecall+EduLevel+Laterality+UsedToEnigmas',family='binomial',data)
mdl1=glm('InsightPost~1+SleepEdison+Age+Gender+Epworth+DreamRecall+EduLevel+Laterality+UsedToEnigmas',family='binomial',data)
anova(mdl0,mdl1, test = "Chisq")
mdl2=glm('InsightPost~1+Bottle+Age+Gender+Epworth+DreamRecall+EduLevel+Laterality+UsedToEnigmas',family='binomial',data)
anova(mdl0,mdl2, test = "Chisq")
mdl3=glm('InsightPost~1+SleepEdison*Bottle+Age+Gender+Epworth+DreamRecall+EduLevel+Laterality+UsedToEnigmas',family='binomial',data)
anova(mdl1,mdl3, test = "Chisq")
mdl4=glm('InsightPost~1+SleepEdison+HypnoEdisonN1+HypnoEdisonN2+Age+Gender+Epworth+DreamRecall+EduLevel+Laterality+UsedToEnigmas',family='binomial',data)
summary(mdl4)
mdl5=glm('InsightPost~1+SleepEdison+HypnoEdisonN1+HypnoEdisonN2+Hypnagogia+HypnaBottle+HypnaTask+
Age+Gender+Epworth+DreamRecall+EduLevel+Laterality+UsedToEnigmas',family='binomial',data)
summary(mdl5)
mdl0=glm('InsightPost~1',family='binomial',data)
mdlcov=glm('InsightPost~1+Age+Gender+Epworth+DreamRecall+EduLevel+Laterality+UsedToEnigmas',family='binomial',data)
anova(mdl0,mdlcov, test = "Chisq")
library(ggplot2)
library(lme4)
data <- read.table("../Edison_Tables/Clean_Data_SS_Pow.txt", header = TRUE, sep = ",", stringsAsFactors = FALSE)
mdl0=glm('InsightPost~1',family='binomial',data)
mdlcov=glm('InsightPost~1+Age+Gender+Epworth+DreamRecall+EduLevel+Laterality+UsedToEnigmas',family='binomial',data)
anova(mdl0,mdlcov, test = "Chisq")
mdl1=glm('InsightPost~1+SleepEdison',family='binomial',data)
anova(mdl0,mdl1, test = "Chisq")
mdl2=glm('InsightPost~1+Bottle',family='binomial',data)
anova(mdl0,mdl2, test = "Chisq")
mdl3=glm('InsightPost~1+SleepEdison*Bottle',family='binomial',data)
anova(mdl1,mdl3, test = "Chisq")
mdl4=glm('InsightPost~1+SleepEdison+HypnoEdisonN1+HypnoEdisonN2',family='binomial',data)
summary(mdl4)
mdl5=glm('InsightPost~1+SleepEdison+HypnoEdisonN1+HypnoEdisonN2+Hypnagogia+HypnaBottle+HypnaTask',family='binomial',data)
summary(mdl5)
data <- read.table("../Edison_Tables/Clean_Data_SS_Pow.txt", header = TRUE, sep = ",", stringsAsFactors = FALSE)
View(data)
View(data)
View(data)
View(data)
summary(data)
mdl5=glm('InsightPost~1+SleepEdison+AASM_W+AASM_N1+AASM_N2',family='binomial',data)
summary(mdl5)
mdl5=glm('InsightPost~1+SleepEdison+AASM_W+AASM_N1+AASM_N2+STAGES_W+STAGES_N1+STAGES_N2',family='binomial',data)
summary(mdl5)
mdl5=glm('InsightPost~1+SleepEdison+STAGES_W+STAGES_N1+STAGES_N2',family='binomial',data)
summary(mdl5)
mdl5=glm('InsightPost~1+SleepEdison+HypnoEdisonN1+HypnoEdisonN2+STAGES_W+STAGES_N1+STAGES_N2',family='binomial',data)
summary(mdl5)
summary(data)
mdl5=glm('InsightPost~1+SleepEdison+HypnoEdisonN1+HypnoEdisonN2+STAGES_W+STAGES_N1+STAGES_N2',family='binomial',data)
summary(mdl5)
mdl5=glm('InsightPost~1+SleepEdison+AASM_N1+AASM_N2+STAGES_W+STAGES_N1+STAGES_N2',family='binomial',data)
summary(mdl5)
mdl5=glm('InsightPost~1+SleepEdison+AASM_N1+AASM_N2+STAGES_N1+STAGES_N2',family='binomial',data)
summary(mdl5)
mdl5=glm('InsightPost~1+SleepEdison+AASM_N1+AASM_N2',family='binomial',data)
anova(mdl1,mdl5)
mdl1=glm('InsightPost~1+SleepEdison',family='binomial',data)
mdl5=glm('InsightPost~1+SleepEdison+AASM_N1+AASM_N2',family='binomial',data)
anova(mdl1,mdl5)
mdl1b=glm('InsightPost~1+SleepEdison+AASM_N1+AASM_N2',family='binomial',data[is.na(data.AASM_N1)=='FALSE',])
is.na(data.AASM_N1)=='FALSE'
data[is.na(data$AASM_N1)=='FALSE',]
mdl1b=glm('InsightPost~1+SleepEdison+AASM_N1+AASM_N2',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
mdl5=glm('InsightPost~1+SleepEdison+AASM_N1+AASM_N2',family='binomial',data)
anova(mdl1,mdl5)
A=data[is.na(data$AASM_N1)=='FALSE',]
mdl1b=glm('InsightPost~1+SleepEdison+AASM_N1+AASM_N2',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
mdl5=glm('InsightPost~1+SleepEdison+AASM_N1+AASM_N2',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1,mdl5)
mdl1b=glm('InsightPost~1+SleepEdison+AASM_N1+AASM_N2',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
mdl5=glm('InsightPost~1+SleepEdison+AASM_N1+AASM_N2',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1b,mdl5)
mdl1b=glm('InsightPost~1+SleepEdison+AASM_N1+AASM_N2',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
mdl5=glm('InsightPost~1+SleepEdison+AASM_N1+AASM_N2',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1b,mdl5, test = "Chisq")
mdl1b=glm('InsightPost~1+SleepEdison',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
mdl5=glm('InsightPost~1+SleepEdison+AASM_N1+AASM_N2',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1b,mdl5, test = "Chisq")
summary(data)
mdl1b=glm('InsightPost~1+SleepEdison',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
mdl5=glm('InsightPost~1+SleepEdison+AASM_N1+AASM_N2',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1b,mdl5, test = "Chisq")
mdl6=glm('InsightPost~1+SleepEdison+STAGES_N1+STAGES_N2',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1b,mdl6, test = "Chisq")
summary(mdl6)
glm('InsightPost~1+STAGES_N1+STAGES_N2',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
m=glm('InsightPost~1+STAGES_N1+STAGES_N2',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
summary(m)
m=glm('InsightPost~1+AASM_N1+AASM_N2',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
summary(m)
mdl1b=glm('InsightPost~1+SleepEdison',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
mdl5=glm('InsightPost~1+AASM_N1+AASM_N2',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1b,mdl5, test = "Chisq")
mdl6=glm('InsightPost~1+STAGES_N1+STAGES_N2',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1b,mdl6, test = "Chisq")
mdl5=glm('InsightPost~1+PowDeltaN+PowThetaN+PowAlphaN',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1b,mdl5, test = "Chisq")
mdl6=glm('InsightPost~1+PowSlope+PowBG',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1b,mdl6, test = "Chisq")
mdl1b=glm('InsightPost~1+SleepEdison',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
mdl7=glm('InsightPost~1+PowDeltaN+PowThetaN+PowAlphaN',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1b,mdl7, test = "Chisq")
mdl8=glm('InsightPost~1+PowSlope+PowBG',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1b,mdl8, test = "Chisq")
summary(mdl7)
summary(mdl8)
mdl1b=glm('InsightPost~1+SleepEdison',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
mdl5=glm('InsightPost~1+AASM_N1+AASM_N2',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1b,mdl5, test = "Chisq")
mdl6=glm('InsightPost~1+STAGES_N1+STAGES_N2',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1b,mdl6, test = "Chisq")
data$meanPVT_Diff=data$meanPVT_Post-data$meanPVT_Pre
mdl7=glm('InsightPost~1+AASM_N1+AASM_N2+meanPVT_Diff',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl5,mdl7, test = "Chisq")
mdl1b=glm('InsightPost~1+SleepEdison',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
mdl5=glm('InsightPost~1+AASM_N1+AASM_N2',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1b,mdl5, test = "Chisq")
mdl6=glm('InsightPost~1+STAGES_N1+STAGES_N2',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1b,mdl6, test = "Chisq")
data$meanPVT_Diff=data$meanPVT_Post-data$meanPVT_Pre
mdl7=glm('InsightPost~1+meanPVT_Diff',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1b,mdl7, test = "Chisq")
summary(mdl7)
mdl=glm('meanPVT_Diff~1+SleepEdison+AASM_N1+AASM_N2',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
mdl=glm('meanPVT_Diff~1+SleepEdison+AASM_N1+AASM_N2',data[is.na(data$AASM_N1)=='FALSE',])
mdl=glm('meanPVT_Diff~1+SleepEdison+AASM_N1+AASM_N2',family='normal',data[is.na(data$AASM_N1)=='FALSE',])
mdl=glm('meanPVT_Diff~1+SleepEdison+AASM_N1+AASM_N2',family='gaussian',data[is.na(data$AASM_N1)=='FALSE',])
summary(mdl)
mdl1b=glm('InsightPost~1+SleepEdison',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
mdl7=glm('InsightPost~1+PowDeltaN+PowThetaN+PowAlphaN',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1b,mdl7, test = "Chisq")
mdl8=glm('InsightPost~1+PowSlope+PowBG',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1b,mdl8, test = "Chisq")
mdl1b=glm('InsightPost~1+SleepEdison',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
mdl7=glm('InsightPost~1+SleepEdison+PowDeltaN+PowThetaN+PowAlphaN',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1b,mdl7, test = "Chisq")
mdl8=glm('InsightPost~1+SleepEdison+PowSlope+PowBG',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1b,mdl8, test = "Chisq")
summary(mdl7)
mdl1b=glm('InsightPost~1+SleepEdison',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
mdl7=glm('InsightPost~1+SleepEdison+PowDeltaN+PowThetaAlpha',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1b,mdl7, test = "Chisq")
mdl8=glm('InsightPost~1+SleepEdison+PowSlope+PowBG',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1b,mdl8, test = "Chisq")
summary(mdl7)
summary(mdl8)
mdl1b=glm('InsightPost~1+SleepEdison',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
mdl7=glm('InsightPost~1+SleepEdison+PowDeltaN+PowThetaAlpha',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1b,mdl7, test = "Chisq")
mdl8=glm('InsightPost~1+SleepEdison+PowSlope+PowBG',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1b,mdl8, test = "Chisq")
data_clean$RT_Diff=data_clean$RT_Post-data_clean$RT_Pre
mdl1b=glm('InsightPost~1+SleepEdison',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
mdl7=glm('InsightPost~1+SleepEdison+PowDeltaN+PowThetaAlpha',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1b,mdl7, test = "Chisq")
mdl8=glm('InsightPost~1+SleepEdison+PowSlope+PowBG',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1b,mdl8, test = "Chisq")
data$RT_Diff=data$RT_Post-data$RT_Pre
mdl1c=glm('RT_Diff~1+SleepEdison',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
mdl1b=glm('InsightPost~1+SleepEdison',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
mdl7=glm('InsightPost~1+SleepEdison+PowDeltaN+PowThetaAlpha',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1b,mdl7, test = "Chisq")
mdl8=glm('InsightPost~1+SleepEdison+PowSlope+PowBG',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1b,mdl8, test = "Chisq")
data$RT_Diff=data$RT_Post-data$RT_Pre
mdl1c=lm('RT_Diff~1+SleepEdison',data[is.na(data$AASM_N1)=='FALSE',])
mdl7c=lm('RT_Diff~1+SleepEdison+PowDeltaN+PowThetaAlpha',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1c,mdl7c, test = "Chisq")
mdl8=lm('RT_Diff~1+SleepEdison+PowSlope+PowBG',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1c,mdl8c, test = "Chisq")
mdl1b=glm('InsightPost~1+SleepEdison',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
mdl7=glm('InsightPost~1+SleepEdison+PowDeltaN+PowThetaAlpha',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1b,mdl7, test = "Chisq")
mdl8=glm('InsightPost~1+SleepEdison+PowSlope+PowBG',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1b,mdl8, test = "Chisq")
data$RT_Diff=data$RT_Post-data$RT_Pre
mdl1c=lm('RT_Diff~1+SleepEdison',data[is.na(data$AASM_N1)=='FALSE',])
mdl7c=lm('RT_Diff~1+SleepEdison+PowDeltaN+PowThetaAlpha',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1c,mdl7c, test = "Chisq")
mdl8c=lm('RT_Diff~1+SleepEdison+PowSlope+PowBG',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1c,mdl8c, test = "Chisq")
summary(mdl1c)
summary(mdl7c)
mdl1b=glm('InsightPost~1+SleepEdison',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
mdl7=glm('InsightPost~1+SleepEdison+PowDeltaN+PowThetaAlpha',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1b,mdl7, test = "Chisq")
mdl8=glm('InsightPost~1+SleepEdison+PowSlope+PowBG',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1b,mdl8, test = "Chisq")
data$RT_Diff=data$RT_Post-data$RT_Pre
mdl1c=lm('RT_Post~1+SleepEdison',data[is.na(data$AASM_N1)=='FALSE',])
mdl7c=lm('RT_Post~1+SleepEdison+PowDeltaN+PowThetaAlpha',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1c,mdl7c, test = "Chisq")
mdl8c=lm('RT_Post~1+SleepEdison+PowSlope+PowBG',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1c,mdl8c, test = "Chisq")
summary(mdl1c)
mdl1b=glm('InsightPost~1+SleepEdison',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
mdl7=glm('InsightPost~1+SleepEdison+PowDeltaN+PowThetaAlpha',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1b,mdl7, test = "Chisq")
mdl8=glm('InsightPost~1+SleepEdison+PowSlope+PowBG',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1b,mdl8, test = "Chisq")
data$Correct_Diff=data$Correct_Post-data$Correct_Pre
mdl1c=lm('Correct_Diff~1+SleepEdison',data[is.na(data$AASM_N1)=='FALSE',])
mdl7c=lm('Correct_Diff~1+SleepEdison+PowDeltaN+PowThetaAlpha',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1c,mdl7c, test = "Chisq")
mdl8c=lm('Correct_Diff~1+SleepEdison+PowSlope+PowBG',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1c,mdl8c, test = "Chisq")
summary(mdl1c)
mdl7=glm('InsightPost~1+SleepEdison+PowDeltaN+PowThetaN',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
mdl1b=glm('InsightPost~1+SleepEdison',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
mdl7=glm('InsightPost~1+SleepEdison+PowDeltaN+PowThetaN',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1b,mdl7, test = "Chisq")
mdl8=glm('InsightPost~1+SleepEdison+PowSlope+PowBG',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1b,mdl8, test = "Chisq")
# data$Correct_Diff=data$Correct_Post-data$Correct_Pre
#
# mdl1c=lm('Correct_Diff~1+SleepEdison',data[is.na(data$AASM_N1)=='FALSE',])
#
# mdl7c=lm('Correct_Diff~1+SleepEdison+PowDeltaN+PowThetaAlpha',data[is.na(data$AASM_N1)=='FALSE',])
# anova(mdl1c,mdl7c, test = "Chisq")
#
# mdl8c=lm('Correct_Diff~1+SleepEdison+PowSlope+PowBG',data[is.na(data$AASM_N1)=='FALSE',])
# anova(mdl1c,mdl8c, test = "Chisq")
summary(mdl7)
mdl1b=glm('InsightPost~1+SleepEdison',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
mdl7=glm('InsightPost~1+SleepEdison+PowDeltaN',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1b,mdl7, test = "Chisq")
mdl8=glm('InsightPost~1+SleepEdison+PowSlope+PowBG',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
anova(mdl1b,mdl8, test = "Chisq")
# data$Correct_Diff=data$Correct_Post-data$Correct_Pre
#
# mdl1c=lm('Correct_Diff~1+SleepEdison',data[is.na(data$AASM_N1)=='FALSE',])
#
# mdl7c=lm('Correct_Diff~1+SleepEdison+PowDeltaN+PowThetaAlpha',data[is.na(data$AASM_N1)=='FALSE',])
# anova(mdl1c,mdl7c, test = "Chisq")
#
# mdl8c=lm('Correct_Diff~1+SleepEdison+PowSlope+PowBG',data[is.na(data$AASM_N1)=='FALSE',])
# anova(mdl1c,mdl8c, test = "Chisq")
summary(mdl7)
mdl=glm('InsightPost~1+SleepEdison*PowDeltaN',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
summary(mdl)
mdl=glm('Hypnagogia~1+SleepEdison+PowDeltaN',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
summary(mdl)
mdl=glm('Hypnagogia~1+SleepEdison+PowDeltaN+Christy Canyon',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
mdl=glm('Hypnagogia~1+SleepEdison+PowDeltaN+HypnoEdisonN2',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
mdl
summary(mdl)
mdl=glm('InsightPost~1+SleepEdison+PowDeltaN+HypnoEdisonN2',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
summary(mdl)
mdl=glm('InsightPost~1+SleepEdison+PowDeltaN+HypnoEdisonN2+PowBG',family='binomial',data[is.na(data$AASM_N1)=='FALSE',])
summary(mdl)
library(ggplot2)
library(lme4)
data <- read.table("../Edison_Tables/Clean_Data_SS_Pow_LS.txt", header = TRUE, sep = ",", stringsAsFactors = FALSE)
mdl0=glm('InsightPost~1',family='binomial',data)
mdlcov=glm('InsightPost~1+Age+Gender+Epworth+DreamRecall+EduLevel+Laterality+UsedToEnigmas',family='binomial',data)
anova(mdl0,mdlcov, test = "Chisq")
mdl1=glm('InsightPost~1+SleepEdison',family='binomial',data)
anova(mdl0,mdl1, test = "Chisq")
mdl2=glm('InsightPost~1+Bottle',family='binomial',data)
anova(mdl0,mdl2, test = "Chisq")
mdl3=glm('InsightPost~1+SleepEdison*Bottle',family='binomial',data)
anova(mdl1,mdl3, test = "Chisq")
mdl1b=glm('InsightPost~1+SleepEdison',family='binomial',data[is.na(data$LSdens)=='FALSE',])
mdl7=glm('InsightPost~1+SleepEdison+LSdens',family='binomial',data[is.na(data$LSdens)=='FALSE',])
anova(mdl1b,mdl7, test = "Chisq")
mdl8=glm('InsightPost~1+SleepEdison+LSdens+LSamp+LSdslp+LSuslp',family='binomial',data[is.na(data$LSdens)=='FALSE',])
anova(mdl1b,mdl8, test = "Chisq")
summary(mdl7)
summary(mdl8)
library(ggplot2)
library(lme4)
data <- read.table("../Edison_Tables/Clean_Data_SS_Pow_LS.txt", header = TRUE, sep = ",", stringsAsFactors = FALSE)
mdl0=glm('InsightPost~1',family='binomial',data)
mdlcov=glm('InsightPost~1+Age+Gender+Epworth+DreamRecall+EduLevel+Laterality+UsedToEnigmas',family='binomial',data)
anova(mdl0,mdlcov, test = "Chisq")
mdl1=glm('InsightPost~1+SleepEdison',family='binomial',data)
anova(mdl0,mdl1, test = "Chisq")
mdl2=glm('InsightPost~1+Bottle',family='binomial',data)
anova(mdl0,mdl2, test = "Chisq")
mdl3=glm('InsightPost~1+SleepEdison*Bottle',family='binomial',data)
anova(mdl1,mdl3, test = "Chisq")
mdl1b=glm('InsightPost~1+SleepEdison',family='binomial',data[is.na(data$LSdens)=='FALSE',])
mdl7=glm('InsightPost~1+SleepEdison+LSdens',family='binomial',data[is.na(data$LSdens)=='FALSE',])
anova(mdl1b,mdl7, test = "Chisq")
mdl8=glm('InsightPost~1+SleepEdison+LSdens+LSamp+LSdslp+LSuslp',family='binomial',data[is.na(data$LSdens)=='FALSE',])
anova(mdl1b,mdl8, test = "Chisq")
summary(mdl7)
summary(mdl8)
library(ggplot2)
library(lme4)
data <- read.table("../Edison_Tables/Clean_Data_SS_Pow_LS.txt", header = TRUE, sep = ",", stringsAsFactors = FALSE)
mdl0=glm('InsightPost~1',family='binomial',data)
mdlcov=glm('InsightPost~1+Age+Gender+Epworth+DreamRecall+EduLevel+Laterality+UsedToEnigmas',family='binomial',data)
anova(mdl0,mdlcov, test = "Chisq")
mdl1=glm('InsightPost~1+SleepEdison',family='binomial',data)
anova(mdl0,mdl1, test = "Chisq")
mdl2=glm('InsightPost~1+Bottle',family='binomial',data)
anova(mdl0,mdl2, test = "Chisq")
mdl3=glm('InsightPost~1+SleepEdison*Bottle',family='binomial',data)
anova(mdl1,mdl3, test = "Chisq")
mdl1b=glm('InsightPost~1+SleepEdison',family='binomial',data[is.na(data$LSdens)=='FALSE',])
mdl7=glm('InsightPost~1+SleepEdison+LSdens',family='binomial',data[is.na(data$LSdens)=='FALSE',])
anova(mdl1b,mdl7, test = "Chisq")
mdl8=glm('InsightPost~1+SleepEdison+LSdens+LSamp+LSdslp+LSuslp',family='binomial',data[is.na(data$LSdens)=='FALSE',])
anova(mdl1b,mdl8, test = "Chisq")
summary(mdl7)
summary(mdl8)
mdl2=glm('InsightPost~1+TimeBallFell_1+timeN1Edison+Fall+Edisonlatency+AsleepTime',family='binomial',data)
mdl2=glm('InsightPost~1+timeBallFell_1+timeN1Edison+Fall+Edisonlatency+AsleepTime',family='binomial',data)
summary(mdl2)
summary(glm('InsightPost~1+AsleepTime',family='binomial',data))
summary(glm('InsightPost~1+Fall',family='binomial',data))
summary(glm('InsightPost~1+SleepEdison+Fall',family='binomial',data))
summary(glm('InsightPost~1+Edisonlatency',family='binomial',data))
library(ggplot2)
library(lme4)
data <- read.table("../Edison_Tables/Clean_Data_SS_Pow_LS.txt", header = TRUE, sep = ",", stringsAsFactors = FALSE)
mdl0=glm('InsightPost~1',family='binomial',data)
mdlcov=glm('InsightPost~1+Age+Gender+Epworth+DreamRecall+EduLevel+Laterality+UsedToEnigmas',family='binomial',data)
anova(mdl0,mdlcov, test = "Chisq")
mdl1=glm('InsightPost~1+SleepEdison',family='binomial',data)
anova(mdl0,mdl1, test = "Chisq")
mdl2=glm('InsightPost~1+Fall',family='binomial',data)
anova(mdl0,mdl2, test = "Chisq")
mdl3=glm('InsightPost~1+SleepEdison*Fall',family='binomial',data)
anova(mdl1,mdl3, test = "Chisq")
summary(mdl2)
summary(data)
library(ggplot2)
library(lme4)
data <- read.table("../Edison_Tables/Clean_Data_SS_Pow_LS.txt", header = TRUE, sep = ",", stringsAsFactors = FALSE)
mdl0=glm('InsightPost~1',family='binomial',data)
mdlcov=glm('InsightPost~1+Age+Gender+Epworth+DreamRecall+EduLevel+Laterality+UsedToEnigmas',family='binomial',data)
anova(mdl0,mdlcov, test = "Chisq")
mdl1=glm('InsightPost~1+SleepEdison',family='binomial',data)
anova(mdl0,mdl1, test = "Chisq")
mdl2=glm('InsightPost~1+Bottle',family='binomial',data)
anova(mdl0,mdl2, test = "Chisq")
mdl3=glm('InsightPost~1+SleepEdison*Fall',family='binomial',data)
anova(mdl1,mdl3, test = "Chisq")
summary(mdl2)
